<!DOCTYPE html>
<html>
	<head>
		<title>
			LT Exercise -- Noun Plurals
		</title>
		<script type="text/javascript" src="js/Common.js"> </script>
		<script>
			SetupArrayRandomFunction();
			var levelledArray = {};

			// Build constructor
			levelledArray.Create = function(arr, functionToLevel){								
				this.Elements = arr.GroupBy((elem) => (functionToLevel(elem)), "Level");
				this.Buttons = this.Elements.map((elem) => ({
					id: 'BtnChooseLevel' + elem.Level,
					html: '<button class="buttonNotActive" onclick="ButtonClicked(this)" value="' + elem.Level + '">' + elem.Level + '</button>'
				}));
				this.CurrentLevel = Math.min(...this.Elements.map(elem => elem.Level));
			};

			// Build button object
			levelledArray.GenerateLevelButton = function(level, isActive){
				return {
					level,
					isActive
				};
			};

			// Returns button's html
			levelledArray.GenerateButtonHtml = function(buttonObject, onClickFunctionName){
				let className = buttonObject.isActive ? "buttonActive" : "buttonNotActive";
				let level = buttonObject.level;
				let id = 'BtnChooseLevel' + level;
				let onClick = onClickFunctionName + '(this)';

				var result = '<button class="' + className +'" onclick="' + onClickFunctionName + '(this)" value="' + level + '">' + level + '</button>'

				return result;
			}

			// Functions returns the full html for the buttonsDiv element
			levelledArray.RegenerateButtons = function(functionToCallOnClick_Name){
				var result = '<div>';

				let buttonHtmls = this.Elements
					.map((elem) => this.GenerateLevelButton(elem.Level, elem.Level == this.CurrentLevel))
					.map(button => this.GenerateButtonHtml(button, functionToCallOnClick_Name));

				result += buttonHtmls
					.reduce((total, current) => total + current, '');

				result += '</div>';

				return result;
			}

			// Build button generation
			levelledArray.GenerateButtonsDiv = function(){
				let result = '<div>';
				this.Buttons.forEach(button => result += button.html);
				result += '</div>'
				return result;
			};
			
			// Setup current level
			levelledArray.SetupLevel = function(newLevelToSetup){
				this.CurrentLevel = newLevelToSetup;												
			}

			// Setup content generation based on the level
			levelledArray.GetContent = function(){
				return this.Elements
					.filter(group => group.Level <= this.CurrentLevel)
					.reduce((
						total, current) => [...total, ...current.values],
						[]);
			}

			var source = ['one', 'two', 'three', 'four', 'five', 'six'];
			levelledArray.Create(source, (elem)=> 1 + Math.floor(source.indexOf(elem) / 2));
			var buttonsHtml = levelledArray.GenerateButtonsDiv();
			console.log(levelledArray);

			function ButtonClicked(btn){		
				
				levelledArray.SetupLevel(btn.value);
				let newHtml = levelledArray.RegenerateButtons("ButtonClicked");
				var buttonsElement = document.getElementById("LevelButtons");
				buttonsElement.innerHTML = newHtml;
			}
		</script>
	<style>
	.buttonNotActive {	  
		border: none;	  
		padding: 15px 32px;
		text-align: center;
		font-size: 16px;
		margin: 4px 2px;		
	}
	
	.buttonActive {	  
		border: 2px solid green;	  
		padding: 15px 32px;
		text-align: center;
		font-size: 16px;
		margin: 4px 2px;		
	}
</style>
	</head>
	<body>
		<div id="LevelButtons">
			<button class="buttonNotActive" onclick="ButtonClicked(this)" value="1">1</button>
			<button class="buttonNotActive" value="2"> 2 </button>
			<button class="buttonActive" value="3"> 3 </button>
			<button class="buttonActive" value="4"> 4 </button>
			<button class="buttonActive" value="5"> 5 </button>
			<button class="buttonActive" value="6"> 6 </button>
			<button class="buttonActive" value="7"> 7 </button>			
		</div>

		<script>
			var buttonsElement = document.getElementById("LevelButtons");
			buttonsElement.innerHTML = buttonsHtml;
		</script>
	</body>
</html>
